**简要说明**<br>
<br>
如果你有一个plecs standalone的模型，这个工具箱可以允许你在matlab里对模型进行扫频。<br>
<br>
所需支持：请先按照[plecs官网](https://www.plexim.com/cn/node/2253) 的指示，配置matlab与plecs之间的通信设定。<br>
<br>
**仓库内容说明**<br>
<br>
_Sim_TF1phase_sweep_plecs.m_ 与 _Test1p.plecs_ 是最开始做的，一个是单频点谐波扫频程序，一个是它配套的 plecs 模型。<br>
如果你想使用这套工具箱中的任何一项扫频功能，建议你先读一下把单相的程序开头的那段注释。按照那段注释配置出来的就是 Test1p.plecs 。<br>
<br>
后续，为了对三相系统扫频的需求，又写了同步系的 _Sim_TFdq_sweep_plecs.m_ 与正负序的 _Sim_TFpn_sweep_plecs.m_ 。<br>
后写的这两个程序省略了最开头那部分注释。<br>
至于与它们配套的基本仿真程序 _TestDQ.plecs_ 和 _TestPN.plecs_ ，在单相的基础上加了很多东西，但仍然是从左到右“注入”-“被测系统”-“输出”的模式。
<br>
此外， _myBodeCal.m_ 是对解析传函获取数组，以便后续与采样数据一起在 plot 指令里画 Bode 图的函数，它在 MATLAB 的 bode 指令基础上加了一些整理；<br>
_myBodeFix.m_ 是对用 plot 指令画好的 Bode 子图做整理的函数。图被它整过之后会漂亮一些。<br>
它们都有在扫频程序里被调用。也欢迎你自行调用。<br>
<br>
三个扫频程序都包括扫频、结果存储、画图。<br>
在画图这方面，单相扫频程序中支持将解析传函一起画入，与 abs/dB 画图选项；DQ 和 PN 因为偷懒了，所以只支持扫频点的 abs 画图。如果你需要dB，就自己改改吧。<br>
以及，DQ 和 PN 为了能把2*2的Bode图画在一张画布上，对画布和子图的 Position 做了点自定义配置。且为了防遮挡，把白背景取消了。<br>
<br>
**使用说明**<br>
<br>
假设你已经在 plecs 中搭建了一个变流器模型，现在你有两种方法应用这套扫频工具。<br>
第一种方法，将你的模型复制进来，替换掉某一个模型的**待测系统**部分。在 _Test1p.plecs_ 中，这部分是 Gi；
在 _TestDQ.plecs_ 和 _TestPN.plecs_ 中，这部分是左中右，中间的那个框。然后把你的模型需要的初始化指令（如果有）复制过来。<br>
第二种方法，将本仓库的任一 _Textxx.plecs_ 中的注入模块与输出模块复制进你的模型中。把**仿真时间配置**与**初始化指令**也复制过去。<br>
然后运行与其配套的matlab代码就行了。<br>
<br>
**现在的局限**<br>
<br>
为了防止系统对谐波响应暂态与注入谐波之间耦合影响响应计算，每个通道每个频点谐波注入都需要单独进行一次仿真。<br>
扫频频点的最小分辨率为 1 Hz 。也就是，你可以把 1 Hz 和 49 Hz 添加到待测频点列表里，但 0.1 Hz 或者 49.5 Hz 是不行的。<br>
提醒：对于正负序耦合响应的相位符号定义，各人定义可能不同。在使用之前，请先试运行一下例程的运行结果是否与你一贯的定义匹配。<br>
